# ğŸ›¡ï¸ å¡©å°»ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ã‚·ãƒ¼ã‚«ãƒ¼ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¬ã‚¤ãƒ‰

[![Security Status](https://img.shields.io/badge/Security-Enterprise%20Grade-green.svg)](docs/SECURITY.md)
[![OWASP](https://img.shields.io/badge/OWASP-Top%2010%20Compliant-blue.svg)](https://owasp.org/www-project-top-ten/)
[![ISO 27001](https://img.shields.io/badge/ISO-27001%20Aligned-purple.svg)](https://www.iso.org/isoiec-27001-information-security.html)
[![Encryption](https://img.shields.io/badge/Encryption-AES%20256-yellow.svg)](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard)

## ğŸ“‹ æ¦‚è¦
å¡©å°»ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ã‚·ãƒ¼ã‚«ãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®**ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–**ã¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ã™ã€‚å¤šå±¤é˜²å¾¡ã¨ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹å …ç‰¢ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

## ğŸ¯ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åŸå‰‡
| åŸå‰‡ | èª¬æ˜ | å®Ÿè£… |
|------|------|------|
| **ğŸ”’ ã‚¼ãƒ­ãƒˆãƒ©ã‚¹ãƒˆ** | ä½•ã‚‚ä¿¡é ¼ã›ãšã€ã™ã¹ã¦ã‚’æ¤œè¨¼ | å¤šè¦ç´ èªè¨¼ãƒ»ç¶™ç¶šçš„æ¤œè¨¼ |
| **ğŸ›¡ï¸ æœ€å°æ¨©é™** | å¿…è¦æœ€å°é™ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ | RBACãƒ»å‹•çš„æ¨©é™ç®¡ç† |
| **ğŸŒŠ å¤šå±¤é˜²å¾¡** | è¤‡æ•°ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å±¤ã§ä¿è­· | WAFãƒ»IDSãƒ»æš—å·åŒ– |
| **ğŸ“Š ç¶™ç¶šç›£è¦–** | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è„…å¨æ¤œçŸ¥ | SIEMãƒ»ç•°å¸¸æ¤œçŸ¥ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ |
| **ğŸ”„ è‡ªå‹•åŒ–** | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ—ãƒ­ã‚»ã‚¹è‡ªå‹•åŒ– | DevSecOpsãƒ»è‡ªå‹•ãƒ‘ãƒƒãƒ |

### ğŸ¯ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é©ç”¨ç¯„å›²
```mermaid
graph TB
    A[ğŸŒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤] --> B[â˜ï¸ ã‚¤ãƒ³ãƒ•ãƒ©å±¤]
    B --> C[ğŸ’¾ ãƒ‡ãƒ¼ã‚¿å±¤]
    C --> D[ğŸ”— ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤]
    D --> E[ğŸ‘¤ ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±¤]
    E --> F[ğŸ” ç›£è¦–ãƒ»ç›£æŸ»å±¤]
```

### ğŸ›ï¸ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œ
- âœ… **OWASP Top 10** å®Œå…¨å¯¾å¿œ
- âœ… **ISO 27001** ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†
- âœ… **NIST ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯** æº–æ‹ 
- âœ… **GDPR** ãƒ‡ãƒ¼ã‚¿ä¿è­·è¦åˆ¶å¯¾å¿œ
- âœ… **æ—¥æœ¬å€‹äººæƒ…å ±ä¿è­·æ³•** å¯¾å¿œ

## èªè¨¼ãƒ»èªå¯

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼

#### JWTèªè¨¼
```javascript
// JWTè¨­å®š
const jwt = require('jsonwebtoken');

const generateToken = (user) => {
  return jwt.sign(
    { 
      id: user.id, 
      email: user.email,
      role: user.role 
    },
    process.env.JWT_SECRET,
    { 
      expiresIn: '24h',
      issuer: 'shiojiri-rainbow-seeker',
      audience: 'api-users'
    }
  );
};
```

#### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒªã‚·ãƒ¼
```javascript
// ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¦ä»¶
const passwordPolicy = {
  minLength: 8,
  requireUppercase: true,
  requireLowercase: true,
  requireNumbers: true,
  requireSpecialChars: true,
  maxAge: 90, // æ—¥æ•°
  historyCount: 5 // éå»ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨˜éŒ²æ•°
};
```

#### å¤šè¦ç´ èªè¨¼ï¼ˆMFAï¼‰
```javascript
// TOTPå®Ÿè£…
const speakeasy = require('speakeasy');

const generateMFASecret = () => {
  return speakeasy.generateSecret({
    name: 'Shiojiri Rainbow Seeker',
    issuer: 'Shiojiri City',
    length: 32
  });
};
```

### 2. APIèªè¨¼

#### API ã‚­ãƒ¼ç®¡ç†
```javascript
// API ã‚­ãƒ¼æ¤œè¨¼
const validateApiKey = (req, res, next) => {
  const apiKey = req.headers['x-api-key'];
  
  if (!apiKey) {
    return res.status(401).json({ error: 'API key required' });
  }
  
  // API ã‚­ãƒ¼ã®æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
  if (!isValidApiKey(apiKey)) {
    return res.status(401).json({ error: 'Invalid API key' });
  }
  
  next();
};
```

#### ãƒ¬ãƒ¼ãƒˆåˆ¶é™
```javascript
// Express rate limiter
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15åˆ†
  max: 100, // æœ€å¤§ãƒªã‚¯ã‚¨ã‚¹ãƒˆæ•°
  message: 'Too many requests from this IP',
  standardHeaders: true,
  legacyHeaders: false,
});
```

## ãƒ‡ãƒ¼ã‚¿ä¿è­·

### 1. æš—å·åŒ–

#### ä¿å­˜æ™‚æš—å·åŒ–
```javascript
// ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æš—å·åŒ–
const crypto = require('crypto');

const encrypt = (text, key) => {
  const algorithm = 'aes-256-gcm';
  const iv = crypto.randomBytes(16);
  const cipher = crypto.createCipher(algorithm, key, iv);
  
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  
  const authTag = cipher.getAuthTag();
  
  return {
    encrypted: encrypted,
    iv: iv.toString('hex'),
    authTag: authTag.toString('hex')
  };
};
```

#### é€šä¿¡æš—å·åŒ–
```yaml
# Kubernetes TLSè¨­å®š
apiVersion: v1
kind: Secret
metadata:
  name: api-tls
  namespace: shiojiri-rainbow-seeker
type: kubernetes.io/tls
data:
  tls.crt: <base64-encoded-cert>
  tls.key: <base64-encoded-key>
```

### 2. å€‹äººæƒ…å ±ä¿è­·

#### ãƒ‡ãƒ¼ã‚¿ãƒã‚¹ã‚­ãƒ³ã‚°
```javascript
// å€‹äººæƒ…å ±ãƒã‚¹ã‚­ãƒ³ã‚°
const maskPersonalData = (data) => {
  return {
    ...data,
    email: data.email.replace(/(.{2}).*@/, '$1***@'),
    phone: data.phone.replace(/(\d{3})-(\d{4})-(\d{4})/, '$1-****-$3'),
    location: {
      latitude: Math.round(data.location.latitude * 100) / 100,
      longitude: Math.round(data.location.longitude * 100) / 100
    }
  };
};
```

#### ãƒ‡ãƒ¼ã‚¿ä¿æŒæœŸé–“
```javascript
// è‡ªå‹•ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
const cleanupOldData = async () => {
  const retentionDays = {
    access_logs: 90,
    user_activities: 365,
    sightings: 1095 // 3å¹´
  };
  
  for (const [table, days] of Object.entries(retentionDays)) {
    await db.query(`
      DELETE FROM ${table} 
      WHERE created_at < NOW() - INTERVAL '${days} days'
    `);
  }
};
```

## å…¥åŠ›æ¤œè¨¼

### 1. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¤œè¨¼
```javascript
// Joi ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
const Joi = require('joi');

const sightingSchema = Joi.object({
  location: Joi.object({
    latitude: Joi.number().min(-90).max(90).required(),
    longitude: Joi.number().min(-180).max(180).required()
  }).required(),
  description: Joi.string().max(1000).required(),
  image_url: Joi.string().uri().required()
});
```

### 2. SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–
```javascript
// ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒª
const getSightings = async (userId, limit, offset) => {
  const query = `
    SELECT * FROM sightings 
    WHERE user_id = $1 
    ORDER BY created_at DESC 
    LIMIT $2 OFFSET $3
  `;
  
  return await db.query(query, [userId, limit, offset]);
};
```

### 3. XSSå¯¾ç­–
```javascript
// ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
const sanitizeHtml = require('sanitize-html');

const sanitizeUserInput = (input) => {
  return sanitizeHtml(input, {
    allowedTags: [],
    allowedAttributes: {},
    disallowedTagsMode: 'escape'
  });
};
```

## ã‚¤ãƒ³ãƒ•ãƒ©ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

### 1. ã‚³ãƒ³ãƒ†ãƒŠã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### ã‚»ã‚­ãƒ¥ã‚¢Dockerfile
```dockerfile
# ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ™ãƒ¼ã‚¹ã‚¤ãƒ¡ãƒ¼ã‚¸
FROM node:18-alpine

# érootãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nextjs -u 1001

# ä¸è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‰Šé™¤
RUN apk del .gyp

# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
RUN apk update && apk upgrade

# æ¨©é™è¨­å®š
USER nextjs
```

#### ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³
```bash
# Trivy ã‚¹ã‚­ãƒ£ãƒ³
trivy image --severity HIGH,CRITICAL your-registry/shiojiri-rainbow-seeker-backend:latest

# è„†å¼±æ€§ãƒ¬ãƒãƒ¼ãƒˆ
trivy image --format json --output report.json your-registry/shiojiri-rainbow-seeker-backend:latest
```

### 2. Kubernetes ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### Pod Security Standards
```yaml
# Pod Security Policy
apiVersion: v1
kind: Namespace
metadata:
  name: shiojiri-rainbow-seeker
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
```

#### RBACè¨­å®š
```yaml
# Service Account
apiVersion: v1
kind: ServiceAccount
metadata:
  name: backend-service-account
  namespace: shiojiri-rainbow-seeker

---
# Role
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: backend-role
  namespace: shiojiri-rainbow-seeker
rules:
- apiGroups: [""]
  resources: ["pods", "configmaps", "secrets"]
  verbs: ["get", "list"]

---
# RoleBinding
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: backend-binding
  namespace: shiojiri-rainbow-seeker
subjects:
- kind: ServiceAccount
  name: backend-service-account
  namespace: shiojiri-rainbow-seeker
roleRef:
  kind: Role
  name: backend-role
  apiGroup: rbac.authorization.k8s.io
```

#### Network Policy
```yaml
# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†é›¢
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: backend-network-policy
  namespace: shiojiri-rainbow-seeker
spec:
  podSelector:
    matchLabels:
      app: backend
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: frontend
    ports:
    - protocol: TCP
      port: 3000
  egress:
  - to:
    - podSelector:
        matchLabels:
          app: postgres
    ports:
    - protocol: TCP
      port: 5432
```

## ç›£è¦–ãƒ»ãƒ­ã‚°

### 1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–

#### ä¸æ­£ã‚¢ã‚¯ã‚»ã‚¹æ¤œçŸ¥
```javascript
// ç•°å¸¸ãªãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œæ¤œçŸ¥
const detectBruteForce = (ip, attempts) => {
  const threshold = 5;
  const timeWindow = 5 * 60 * 1000; // 5åˆ†
  
  if (attempts >= threshold) {
    // IP ã‚’ãƒ–ãƒ­ãƒƒã‚¯
    blockIP(ip, timeWindow);
    
    // ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡
    sendSecurityAlert('Brute force attack detected', { ip, attempts });
  }
};
```

#### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°
```javascript
// ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°
const logSecurityEvent = (event, details) => {
  const logEntry = {
    timestamp: new Date().toISOString(),
    event: event,
    details: details,
    severity: getSeverityLevel(event),
    source_ip: details.ip,
    user_agent: details.userAgent
  };
  
  // SIEM ã«é€ä¿¡
  sendToSIEM(logEntry);
};
```

### 2. ãƒ­ã‚°åˆ†æ

#### ç•°å¸¸æ¤œçŸ¥
```bash
# ç•°å¸¸ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œçŸ¥
kubectl logs deployment/backend -n shiojiri-rainbow-seeker | \
  grep -E "(401|403|429)" | \
  awk '{print $1}' | \
  sort | uniq -c | sort -nr | head -10

# SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³è©¦è¡Œæ¤œçŸ¥
kubectl logs deployment/backend -n shiojiri-rainbow-seeker | \
  grep -i -E "(union|select|insert|update|delete|drop|exec)" | \
  grep -v "normal_query"
```

## è„†å¼±æ€§ç®¡ç†

### 1. ä¾å­˜é–¢ä¿‚ç®¡ç†

#### è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
```bash
# Node.js ä¾å­˜é–¢ä¿‚
npm audit --audit-level high

# Python ä¾å­˜é–¢ä¿‚
pip-audit --desc --format=json

# Docker ã‚¤ãƒ¡ãƒ¼ã‚¸
docker run --rm -v $(pwd):/app securecodewarrior/docker-security-checker /app/Dockerfile
```

#### è‡ªå‹•æ›´æ–°è¨­å®š
```yaml
# Dependabotè¨­å®š
version: 2
updates:
  - package-ecosystem: "npm"
    directory: "/backend"
    schedule:
      interval: "weekly"
    
  - package-ecosystem: "pip"
    directory: "/ml-system"
    schedule:
      interval: "weekly"
```

### 2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒ

#### å®šæœŸæ›´æ–°æ‰‹é †
```bash
#!/bin/bash
# security_update.sh

# 1. è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³
echo "Running security scan..."
npm audit --audit-level high

# 2. ãƒ‘ãƒƒãƒé©ç”¨
echo "Applying security patches..."
npm audit fix

# 3. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
echo "Running tests..."
npm test

# 4. ãƒ‡ãƒ—ãƒ­ã‚¤
echo "Deploying updates..."
kubectl rollout restart deployment/backend -n shiojiri-rainbow-seeker
```

## ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡

### 1. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š

#### AWS Security Group
```yaml
# Terraformè¨­å®š
resource "aws_security_group" "backend" {
  name = "backend-sg"
  
  ingress {
    from_port   = 443
    to_port     = 443
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }
  
  ingress {
    from_port   = 80
    to_port     = 80
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }
  
  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}
```

#### GCP Firewall
```yaml
# firewall-rules.yaml
resource "google_compute_firewall" "backend" {
  name    = "backend-firewall"
  network = "default"

  allow {
    protocol = "tcp"
    ports    = ["443", "80"]
  }

  source_ranges = ["0.0.0.0/0"]
  target_tags   = ["backend"]
}
```

### 2. VPNè¨­å®š

#### WireGuardè¨­å®š
```conf
# wg0.conf
[Interface]
PrivateKey = <private-key>
Address = 10.0.0.1/24
ListenPort = 51820

[Peer]
PublicKey = <public-key>
AllowedIPs = 10.0.0.2/32
Endpoint = <endpoint>:51820
```

## ç½å®³å¾©æ—§

### 1. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æš—å·åŒ–

#### æš—å·åŒ–ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
```bash
# GPGã§ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æš—å·åŒ–
gpg --symmetric --cipher-algo AES256 --compress-algo 1 backup.sql

# æš—å·åŒ–ã•ã‚ŒãŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
aws s3 cp backup.sql.gpg s3://secure-backup-bucket/
```

### 2. å¾©æ—§æ‰‹é †

#### ç·Šæ€¥æ™‚å¾©æ—§
```bash
#!/bin/bash
# emergency_recovery.sh

# 1. æœ€æ–°ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
aws s3 cp s3://secure-backup-bucket/latest-backup.sql.gpg ./

# 2. å¾©å·åŒ–
gpg --decrypt latest-backup.sql.gpg > latest-backup.sql

# 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¾©æ—§
kubectl exec -i postgres-pod -n shiojiri-rainbow-seeker -- psql < latest-backup.sql

# 4. æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
kubectl exec -it postgres-pod -n shiojiri-rainbow-seeker -- psql -c "SELECT COUNT(*) FROM sightings;"
```

## ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹

### 1. ãƒ‡ãƒ¼ã‚¿ä¿è­·è¦åˆ¶

#### GDPRå¯¾å¿œ
```javascript
// ãƒ‡ãƒ¼ã‚¿å‰Šé™¤è¦æ±‚å¯¾å¿œ
const deleteUserData = async (userId) => {
  const transactions = await db.transaction();
  
  try {
    // é–¢é€£ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
    await transactions.query('DELETE FROM sightings WHERE user_id = $1', [userId]);
    await transactions.query('DELETE FROM user_activities WHERE user_id = $1', [userId]);
    await transactions.query('DELETE FROM users WHERE id = $1', [userId]);
    
    await transactions.commit();
    
    // å‰Šé™¤ãƒ­ã‚°
    logDataDeletion(userId);
    
  } catch (error) {
    await transactions.rollback();
    throw error;
  }
};
```

### 2. ç›£æŸ»ãƒ­ã‚°

#### æ“ä½œãƒ­ã‚°è¨˜éŒ²
```javascript
// ç›£æŸ»ãƒ­ã‚°
const auditLogger = (action, resource, user, details) => {
  const auditEntry = {
    timestamp: new Date().toISOString(),
    action: action,
    resource: resource,
    user: user,
    details: details,
    ip: details.ip,
    user_agent: details.userAgent
  };
  
  // ç›£æŸ»ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«è¨˜éŒ²
  auditDB.insert('audit_logs', auditEntry);
};
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

### 1. è„†å¼±æ€§ãƒ†ã‚¹ãƒˆ

#### OWASP ZAP
```bash
# è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
zap-baseline.py -t https://api.shiojiri-rainbow-seeker.com \
  -g gen.conf \
  -r baseline-report.html
```

#### Burp Suite
```bash
# API ãƒ†ã‚¹ãƒˆ
burp-rest-api-scanner --url https://api.shiojiri-rainbow-seeker.com \
  --output burp-report.json
```

### 2. ãƒšãƒãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

#### å®šæœŸãƒ†ã‚¹ãƒˆè¨ˆç”»
```bash
#!/bin/bash
# monthly_pentest.sh

# 1. è‡ªå‹•åŒ–ã•ã‚ŒãŸãƒ†ã‚¹ãƒˆ
echo "Running automated security tests..."
zap-baseline.py -t https://api.shiojiri-rainbow-seeker.com

# 2. æ‰‹å‹•ãƒ†ã‚¹ãƒˆ
echo "Running manual tests..."
# SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ ãƒ†ã‚¹ãƒˆ
# XSS ãƒ†ã‚¹ãƒˆ
# èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ ãƒ†ã‚¹ãƒˆ

# 3. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
echo "Generating security report..."
generate-security-report.py
```

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ•™è‚²

### 1. é–‹ç™ºè€…æ•™è‚²

#### ã‚»ã‚­ãƒ¥ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- OWASP Top 10 ã®ç†è§£
- å…¥åŠ›æ¤œè¨¼ã®å®Ÿè£…
- æš—å·åŒ–ã®é©åˆ‡ãªä½¿ç”¨
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã®å®Ÿæ–½

#### æ•™è‚²è³‡æ–™
- [OWASP ã‚»ã‚­ãƒ¥ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¬ã‚¤ãƒ‰](https://owasp.org/www-project-secure-coding-practices-quick-reference-guide/)
- [ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã‚¬ã‚¤ãƒ‰](./SECURITY_TESTING.md)

### 2. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ

#### å¯¾å¿œæ‰‹é †
1. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆæ¤œçŸ¥
2. å½±éŸ¿ç¯„å›²ã®ç‰¹å®š
3. å°ã˜è¾¼ã‚
4. æ ¹æœ¬åŸå› åˆ†æ
5. å¾©æ—§
6. æ•™è¨“ã®å…±æœ‰

## é€£çµ¡å…ˆ

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒ¼ãƒ 
- **CISO**: ciso@shiojiri-rainbow-seeker.com
- **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢**: security@shiojiri-rainbow-seeker.com
- **ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ**: incident@shiojiri-rainbow-seeker.com

### è„†å¼±æ€§å ±å‘Š
- **ãƒã‚°ãƒã‚¦ãƒ³ãƒ†ã‚£**: bugbounty@shiojiri-rainbow-seeker.com
- **è²¬ä»»ã‚ã‚‹é–‹ç¤º**: disclosure@shiojiri-rainbow-seeker.com

## å‚è€ƒè³‡æ–™
- [OWASP](https://owasp.org/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)
- [ISO 27001](https://www.iso.org/isoiec-27001-information-security.html)
- [Kubernetes Security Guide](https://kubernetes.io/docs/concepts/security/)